---
title : í…ì„œí”Œë¡œìš°, ì¼€ë¼ìŠ¤ ê°œë… ì •ë¦¬
toc : true
toc_sticky : true
---


## PART2 TENSORFLOW
**í…ì„œí”Œë¡œìš°ì˜ ê¸°ëŠ¥ : ìë™ ë¯¸ë¶„ (automatic differentiation)**  

(1) create dataset  
	first, create dataset with â€˜generatorâ€™ ( tf.random ëª¨ë“ˆ )  
    * ì •ê·œë¶„í¬ë¥¼ ê°–ëŠ” 10ê°œì˜ ìˆ«ì ë°ì´í„° -> ë³€ìˆ˜ xì— ì €ì¥  
    * ì„ í˜• í•¨ìˆ˜ì‹ì„ ë§Œì¡±í•˜ëŠ” ê°’ì„ ëŒ€ì… -> ë³€ìˆ˜ yì— ì €ì¥  

> (ì°¸ê³ )  
> â€˜ë”¥ëŸ¬ë‹ ëª¨ë¸ í•™ìŠµâ€™ í•œ ì¤„ ìš”ì•½ :  
> ëª¨ë¸ì˜ ì˜ˆì¸¡ ê°’ & ì‹¤ì œ ê°’ì˜ ì°¨ì´ë¥¼ ìµœì†Œí™”í•˜ëŠ” ëª¨ë¸ì˜ ê³„ìˆ˜, ìƒìˆ˜í•­ì„ ì°¾ëŠ” ê³¼ì •  
> ì—¬ê¸°ì„œ â€˜ì°¨ì´â€™ : loss  

ex_MSE(í‰ê·  ì œê³± ì˜¤ì°¨)ë¥¼ ê³„ì‚°í•˜ëŠ” ì†ì‹¤í•¨ìˆ˜ë¥¼ ì •ì˜í•´ë³´ì
```python
Def cal_mse (X, Y, a, b):
	y_pred = a * X + b
	squared_error = (y_pred - Y) ** 2
	mean_squared_error = tf.reduce_mean(sqaure_error)
	
	return mean_squared_error
```


- - - -

< ì–´ë–»ê²Œ í•™ìŠµì´ ì´ë£¨ì–´ì§€ëŠ”ê°€ >   
1. ëª¨ë¸ì˜ ê³„ìˆ˜ì™€ ìƒìˆ˜í•­ì— í•´ë‹¹í•˜ëŠ” ë³€ìˆ˜ a, bë¥¼ ìƒì„±í•œë‹¤ <â€” ì´ˆê¸°ê°’ì€ ë‘˜ ë‹¤ 0.0  
2. ëª‡ ë²ˆ ëŒë¦´ì§€ ì„¤ì • : 200ì—í¬í¬. 
3. With êµ¬ë¬¸ ì•ˆì—ì„œ ì¼ì–´ë‚˜ëŠ” ì¼
* cal_mse í•¨ìˆ˜ë¡œ ê³„ì‚°í•œ ê²°ê³¼ëŠ” mse ë³€ìˆ˜ì— ì €ì¥  
* Gradient í•¨ìˆ˜ ì‚¬ìš©í•˜ì—¬ ì–»ì–´ì§„ ë¯¸ë¶„ê°’ â€”> grad ë³€ìˆ˜ì— ì €ì¥ (ê³„ìˆ˜ a : g_a, ìƒìˆ˜í•­ b : g_b)  
* ë¯¸ë¶„ê°’ì— í•™ìŠµë¥  0.05ë¥¼ ì ìš©í•˜ì—¬ ê³±í•¨ â€”> ê¸°ì¡´ ê³„ìˆ˜, ìƒìˆ˜í•­ì—ì„œ ì°¨ê°
* ì°¨ê°ëœ ê°’ì„ ë‹¤ìŒ ì—í¬í¬ì˜ ì…ë ¥ê°’ìœ¼ë¡œ ì‚¬ìš©
4. A, b ê°’ì„ ê³„ì† ì—…ë°ì´íŠ¸ í•¨(mseë¥¼ ë‚®ì¶”ëŠ” ë°©í–¥ìœ¼ë¡œ)
5. ê²°ê³¼ : mseëŠ” 0ì— ê°€ê¹Œì›Œì§€ê³  ì‹¤ì œ ê°’ì— ê·¼ì‚¬í•˜ëŠ” ê²ƒì„ í™•ì¸ ê°€ëŠ¥

ì˜ˆì œ ì½”ë“œ : 
```python
#tf.GradientTapeë¡œ ìë™ ë¯¸ë¶„ ê³¼ì •ì„ ê¸°ë¡í•œë‹¤.

a = tf.Variable(0,0)
b = tf.Variable(0,0)

EPOCHS = 200

for epoch in range(1, EPOCHS + 1):
	with tf.GradientTape() as tape :
		mse = cal_mse(X, Y, a, b)
	
	grad = tape.gradient(mse, {â€˜aâ€™:a, â€˜bâ€™:b})
	d_a, d_b = grad[â€˜aâ€™], grad[â€˜bâ€™]

	a.assign_sub(d_a * 0.05)
	b.assign_sub(d_b * 0.05)
	
	if epoch % 20 == 0 :
		print(â€œEPOCH %d - MSE: %.4f â€”â€” a: %.2f â€”â€” b: %.2fâ€ %(epoch, mse, a, b))
```

- - - -

## PART3 KERAS
* í…ì„œí”Œë¡œìš°2ê°€ 1ê³¼ ê°€ì¥ ë‹¤ë¥¸ ì  : ì¼€ë¼ìŠ¤ ë‚´ì¥  
* ì¼€ë¼ìŠ¤ api : ê³ ìˆ˜ì¤€ ë”¥ëŸ¬ë‹ ë¼ì´ë¸ŒëŸ¬ë¦¬  
* ì¼€ë¼ìŠ¤ì˜ íŠ¹ì¥ì  :  
gpu ì—°ì‚° ìˆ˜í–‰ ê¸°ëŠ¥ì„ ì§ì ‘ ëŒë¦¬ì§€ ì•Šê³  ë°±ì—”ë“œ ì—”ì§„ì„ ì§€ì •í•˜ì—¬ ì‚¬ìš©í•œë‹¤ëŠ” ê²ƒ (í…ì„œí”Œë¡œìš° ìœ„ì— ë§Œë“¤ì–´ì§„ ì¼€ë¼ìŠ¤)  
* ì¼€ë¼ìŠ¤ì˜ ëª©ì  : ë”¥ëŸ¬ë‹ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‰½ê³  ê°„ê²°í•œ ì½”ë“œë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ê²ƒ.


**ì£¼ìš” ìš©ì–´**
* í•˜ì´í¼ íŒŒë¼ë¯¸í„°(hyper-parameter)  
-ML ëª¨ë¸ í›ˆë ¨ ì‹œ ì‚¬ìš©ìê°€ ì§ì ‘ ì„¤ì •í•´ì£¼ëŠ” ì„¤ì •ê°’ (ex í•™ìŠµ ì†ë„, ë°˜ë³µ í›ˆë ¨ íšŸìˆ˜ ë“±)  
-ì‚¬ìš©ìê°€ ë³„ë„ ì„¤ì •í•˜ì§€ ì•Šìœ¼ë©´ ê¸°ë³¸ê°’ì´ ìë™ìœ¼ë¡œ ì ìš©ëœë‹¤  
-ëª¨ë¸ì˜ ì˜ˆì¸¡ ì„±ëŠ¥ì„ ë†’ì´ëŠ” ë° ê´€ì—¬í•˜ëŠ” í‚¤í¬ì¸íŠ¸ë“¤ (a.k.a í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹)     

* ê³¼ì†Œì í•© & ê³¼ëŒ€ì í•©  
ë°°ê²½ì§€ì‹ : ML í•™ìŠµì— ì“°ì´ëŠ” ë°ì´í„°ëŠ” ë‘ ì¢…ë¥˜  
	(1) í›ˆë ¨ìš© train set : ML ëª¨ë¸ì´ í•™ìŠµí•  ë°ì´í„°  
	(2) ì˜ˆì¸¡ìš© test set : ML ëª¨ë¸ì´ ì˜ˆì¸¡í•´ì•¼ í•˜ëŠ” ëŒ€ìƒ ë°ì´í„°, ì •ë‹µ ë ˆì´ë¸”ì´ ì—†ë‹¤  
		- í›ˆë ¨ ë°ì´í„°ì—ì„œ íŒ¨í„´ í•™ìŠµì„ ì§„í–‰ -> ëª¨ë¸ì´ ì™„ì„±ë¨  
		- ë°˜ë³µ í•™ìŠµì˜ íš¨ê³¼ : ì‚¬ëŒì´ ëª»ì°¾ëŠ” íŒ¨í„´ì„ ë°œê²¬ -> ì˜ˆì¸¡ ì„±ëŠ¥ì´ ì¢‹ì€ ëª¨ë¸ ìƒì„± 
	- ê³¼ì†Œì í•© : ëª¨ë¸ì´ ì¶©ë¶„íˆ í•™ìŠµë˜ì§€ ì•Šì•„ ì˜ˆì¸¡ ì„±ëŠ¥ì´ ë–¨ì–´ì§„ ìƒíƒœ
	- ê³¼ëŒ€ì í•© : í•™ìŠµ ë°ì´í„°ë¥¼ ì§€ë‚˜ì¹˜ê²Œ í•™ìŠµí•´ì„œ ê·¸ ê²°ê³¼ê°€ ê³¼í•˜ê²Œ ì í•©ëœ ìƒíƒœ
 
    
ğŸ¦ **ê°€ì¥ ë² ìŠ¤íŠ¸ ê²°ê³¼ë¥¼ ë§Œë“¤ë ¤ë©´**  
ê³¼ì†Œì í•©, ê³¼ëŒ€ì í•© ë¬¸ì œë¥¼ ìµœì†Œí™” & ì •í™•ë„ë¥¼ ìµœëŒ€í•œ ë†’ì´ê¸°  
í›ˆë ¨ ë°ì´í„° ì˜ êµ¬ì„±í•˜ê¸° ( í›ˆë ¨ ë°ì´í„° ì˜ˆì¸¡ ë°ì´í„° ë¶„í¬ ë™ì¼í•˜ê²Œ ë§ì¶”ê¸°, ë°ì´í„° ë¶„ì„ ì „ì²˜ë¦¬ë¡œ ë…¸ì´ì¦ˆ ì—†ì• ê¸°, ê²€ì¦ ì„±ëŠ¥ì´ ê°€ì¥ ì¢‹ì€ êµ¬ê°„ì„ ê¸°ì¤€ìœ¼ë¡œ ìµœì¢… ëª¨ë¸ ê²°ì •í•˜ê¸° )

* ì—í¬í¬  
ì—í¬í¬ = 1íšŒ í›ˆë ¨ ë£¨í”„ (ë°˜ë³µ í›ˆë ¨ ì‹œ í›ˆë ¨ ë°ì´í„°ì…‹ì´ ëª¨ë‘ 1ë²ˆ ëª¨ë¸ í›ˆë ¨ì— ì‚¬ìš©ë˜ëŠ” ê²ƒ)

* ì†ì‹¤í•¨ìˆ˜ : ì˜ˆì¸¡ ê°’, ì •ë‹µ ê°’ì˜ ì°¨ì´ / ì˜¤ì°¨

* ì§€ë„í•™ìŠµ  
	(1) ì´ì§„ ë¶„ë¥˜
    * ì†ì‹¤í•¨ìˆ˜ : binary-crossentropy / í™œì„±í™” í•¨ìˆ˜ : sigmoid  

	(2) ë‹¤ì¤‘ ë¶„ë¥˜  
    * ì†ì‹¤í•¨ìˆ˜ : categorical_crossentropy (ë‹¤ì¤‘ ë¶„ë¥˜ ëŒ€ìƒ í´ë˜ìŠ¤ê°€ ì›í•« ë²¡í„°ì¸ ê²½ìš° ì‚¬ìš©)  
    * ì†ì‹¤í•¨ìˆ˜ : sparse_categorical_crossentropy (ë ˆì´ë¸” ê°’ì´ ë‹¤ë¥¸ ìˆ«ìë¡œ êµ¬ë¶„ ëœ ê²½ìš° ì‚¬ìš©)  
    * í™œì„±í™” í•¨ìˆ˜ : softmax


* ê²½ì‚¬í•˜ê°•ë²•  
ë”¥ëŸ¬ë‹ ëª¨ë¸ í›ˆë ¨ ì‹œ, ëª¨ë¸ ë‚´ë¶€ ê°€ì¤‘ì¹˜ì— ëŒ€í•œ ë¯¸ë¶„ ê°’ì„ êµ¬í•˜ê³  ëª©ì  í•¨ìˆ˜ ê°’ì´ ë‚®ì•„ì§€ëŠ” ë°©í–¥ìœ¼ë¡œ ì°¨ê° â€”> ìµœì†Œ í•¨ìˆ˜ ê°’ì„ ê°–ê²Œ í•˜ëŠ” ë°©ë²•
	* ìµœì í™” í•¨ìˆ˜(ì˜µí‹°ë§ˆì´ì €)ì˜ ê·¼ê°„ì´ ë˜ëŠ” ì•Œê³ ë¦¬ì¦˜
